<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Perspective Trainer</title>
    <link rel="stylesheet" href="css/style.css">
    <script type="text/javascript" src="js/paper-full.min.js"></script>
    <script type="text/paperscript" canvas="canvas">

        var path;

        var rect = new Rectangle();
        rect.left = 400;
        rect.right = 500;
        rect.bottom = 400;
        rect.top = 200;

        var rectPath = new Path.Rectangle(rect);
        rectPath.strokeColor='black';

        var vp = new Point(100,350);
        var horizonPath = new Path();
        horizonPath.strokeColor='black';
        horizonPath.add(new Point(30, vp.y), new Point(600, vp.y));

        var vpCircle = new Path.Circle(vp, 3);
        vpCircle.fillColor='black';

        var topLeftCircle = new Path.Circle(new Point(0, 0), 3);
        topLeftCircle.position = new Point(rect.left, rect.top);
        topLeftCircle.fillColor='black';
        topLeftCircle.strokeColor='black';
        topLeftCircle.strokeWidth=0;

        var selectedVertex = "none";
        var activePath = "none";

        var topLeftPath = new Path();
        var topRightPath = new Path();
        var botLeftPath = new Path();
        var botRightPath = new Path();

        var topLeftPathTest = new Path();
        topLeftPathTest.strokeColor = 'transparent';
        topLeftPathTest.add(new Point(rect.left, rect.top));
        topLeftPathTest.add(vp);


        function onMouseDrag(event) {
            if (activePath == "none") return;
            if (activePath == "topLeft") {
                if (topLeftPath.segments.length < 2) {
                    topLeftPath.add(event.point);
                }
                topLeftPath.segments[1].point.x = event.point.x + 50;
                topLeftPath.segments[1].point.y = event.point.y;
            }
            
        }
        
        function onMouseDown(event) {
            if (selectedVertex == "none") return;
            if (selectedVertex == "topLeft") {  
                topLeftPath.strokeColor = 'black';
                topLeftPath.add(new Point(rect.left, rect.top));
                activePath = "topLeft";

                topLeftPathTest.strokeColor='transparent';
            }
        }

        function onMouseMove(event) {
            var delta = event.point - topLeftCircle.position;
            var dist = Math.sqrt(Math.pow(delta.x,2) + Math.pow(delta.y,2));
            if (dist < 50) {
                topLeftCircle.strokeWidth=10;
                selectedVertex = "topLeft";
            } else {
                topLeftCircle.strokeWidth=0;
                if (selectedVertex == "topLeft") selectedVertex = "none";
            }  
        }

        function onMouseUp(event) {
            if (activePath == "topLeft") testTopLeftPath();
            activePath = "none";

        }

        function testTopLeftPath() {
            topLeftPathTest.strokeColor='red';
            
            
        }
    </script>
</head>
<body>
    <canvas id="canvas" resize></canvas>
</body>
</html>
